!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function t(e,t,i){return i&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t,i){return(t=o(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a,o,s=[],c=!0,d=!1;try{if(a=(i=i.call(e)).next,0===t);else for(;!(c=(n=a.call(i)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(u){d=!0,r=u}finally{try{if(!c&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(d)throw r}}return s}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(t,i){if(t){if("string"==typeof t)return e(t,i);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}var d={CALL_LIMIT:10,TIME_THRESHOLD:18e5,SAVE_TIME_ON_PAGE_INTERVAL:1e4,MAX_TIME_ON_PAGE_ITEMS_IN_LOCAL_STORAGE:32,DOMAIN_FPH_KEY:"DotmetricsDomainFPH",TIME_STAMP_LIMIT_24_HOURS:864e5,TIME_STAMP_LIMIT_5_DAYS:432e6},u={DATA_URL:"/SiteEvent.dotmetrics",PING_URL:"/Ping.dotmetrics",POST_URL:"/DeviceInfo.dotmetrics",AJAX_EVENT_URL:"/AjaxEvent.dotmetrics",BEACON_URL:"/BeaconEvent.dotmetrics",ERROR_EVENT_URL:"/ErrorEvent.dotmetrics",EDI_URL:"/edi",EDI_DAILY_URL:"/edi-daily",UIMUrl:"/urls-in-measurement",DOMAIN_SYNC_URL:"/sync"},l=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona","Bell MT","Berlin Sans FB","Corbel","Kalinga","Miriam Regular","Modern Standard","Segoe UI","Segoe Print","Inconsolata","Droid Sans Mono","Anonymous Pro","Liberation Mono","Terminus","Rosario","Roboto Slab","Oswald","Stalemate","Crimson Text","Gravitas One","Jura","League Gothic","Fjord","Proxima Nova","Trivia Grotesk","Pluto Sans","Museo Sans","Futura","Al Bayan","American Typewriter","Andale Mono","Apple Casual","Apple Chancery","Apple Garamond","Apple Gothic","Apple LiGothic","Apple LiSung","Apple Myungjo","Apple Symbols",".AquaKana","Arial Hebrew","Ayuthaya","Baghdad","Baskerville","Beijing","BiauKai","Big Caslon","Brush Script","Chalkboard","Chalkduster","Charcoal","Charcoal CY","Chicago","Cochin","Comic Sans","Cooper","Copperplate","Corsiva Hebrew","DecoType Naskh","Devanagari","Didot","Euphemia UCAS","Fang Song","Gadget","Geeza Pro","Geezah","Geneva","Geneva CY","Gill Sans","Gujarati","Gung Seoche","Gurmukhi","Hangangche","HeadlineA","Hei","Helvetica","Helvetica CY","Helvetica Neue","Herculanum","Hiragino Kaku Gothic Pro","Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Std","Hiragino Kaku Gothic StdN","Hiragino Maru Gothic Pro","Hiragino Maru Gothic ProN","Hiragino Mincho Pro","Hiragino Mincho ProN","Hoefler Text","Inai Mathi","Jung Gothic","Kai","Keyboard","Krungthep","KufiStandard GK","LastResort","LiHei Pro","LiSong Pro","Lucida Grande","Marker Felt","Menlo","Monaco","Monaco CY","Mshtakan","Nadeem","New Peninim","New York","NISC GB18030","Optima","Osaka","Palatino","PC Myungjo","Pilgiche","Plantagenet Cherokee","Raanana","Sand","Sathu","Seoul","Shin Myungjo Neue","Silom","Skia","Song","ST FangSong","ST Heiti","ST Kaiti","ST Song","Symbol","Tae Graphic","Taipei","Techno","Textile","Thonburi","Times CY","Zapf Chancery","Zapf Dingbats","Zapfino","Abadi MT Condensed Light","Aharoni","Aldhabi","Andalus","Angsana New","AngsanaUPC","Aparajita","Arabic Typesetting","Arial Nova","Batang","BatangChe","Book Antiqua","Browallia New","BrowalliaUPC","Calibri","Calibri Light","Calisto MT","Cambria","Cambria Math","Candara","Consolas","Constantia","Copperplate Gothic Bold","Copperplate Gothic Light","Cordia New","CordiaUPC","DaunPenh","David","Dengxian","DFKai-SB","DilleniaUPC","DokChampa","Dotum","DotumChe","Ebrima","Estrangelo Edessa","EucrosiaUPC","Euphemia","FangSong","Franklin Gothic Medium","FrankRuehl","FreesiaUPC","Gabriola","Gadugi","Gautami","Georgia Pro","Gill Sans Nova","Gisha","Gulim","GulimChe","Gungsuh","GungsuhChe","IrisUPC","Iskoola Pota","JasmineUPC","KaiTi","Kartika","Khmer UI","KodchiangUPC","Kokila","Lao UI","Latha","Leelawadee","Leelawadee UI","Levenim MT","LilyUPC","Lucida Handwriting Italic","Lucida Sans Unicode","Malgun Gothic","Mangal","Manny ITC","Marlett","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei UI","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft YaHei UI","Microsoft Yi Baiti","MingLiU, PMingLiU","MingLiU-ExtB, PMingLiU-ExtB","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","Miriam, Miriam Fixed","Mongolian Baiti","MoolBoran","MS Gothic, MS PGothic","MS Mincho, MS PMincho","MS UI Gothic","MV Boli","Myanmar Text","Narkisim","Neue Haas Grotesk Text Pro","News Gothic MT","Nirmala UI","NSimSun","Nyala","Palatino Linotype","Raavi","Rockwell Nova","Rod","Sakkal Majalla","Sanskrit Text","Segoe MDL2 Assets","Segoe Script","Segoe UI v5.00[3]","Segoe UI v5.01[4]","Segoe UI v5.27[5]","Segoe UI v5.35","Segoe UI Emoji","Segoe UI Historic[6]","Segoe UI Symbol","Shonar Bangla","Shruti","SimHei","SimKai","Simplified Arabic","SimSun","SimSun-ExtB","Sitka Banner","Sitka Display","Sitka Heading","Sitka Small","Sitka Subheading","Sitka Text","Sylfaen","Traditional Arabic","Tunga","Urdu Typesetting","Utsaah","Vani","Verdana Pro","Vijaya","Vrinda","Webdings","Westminster","Wingdings","Yu Gothic","Yu Gothic UI","Yu Mincho","Abyssinica SIL","Bitstream Charter","Century Schoolbook L","Courier 10 Pitch","DejaVu Sans","DejaVu Sans Condensed","DejaVu Sans Light","DejaVu Sans Mono","DejaVu Serif","DejaVu Serif Condensed","Dingbats","Droid Arabic Kufi","Droid Arabic Naskh","Droid Naskh Shift Alt","Droid Sans","Droid Sans Arabic","Droid Sans Armenian","Droid Sans Ethiopic","Droid Sans Fallback","Droid Sans Georgian","Droid Sans Hebrew","Droid Sans Japanese","Droid Serif","FreeMono","FreeSans","FreeSerif","Gargi","Garuda","KacstArt","KacstBook","KacstDecorative","KacstDigital","KacstFarsi","KacstLetter","KacstNaskh","KacstOffice","KacstOne","KacstPen","KacstPoster","KacstQurn","KacstScreen","KacstTitle","KacstTitleL","Kedage","Khmer OS","Khmer OS System","Kinnari","Laksaman","Liberation Sans","Liberation Sans Narrow","Liberation Serif","LKLUG","Lohit Bengali","Lohit Devanagari","Lohit Gujarati","Lohit Punjabi","Lohit Tamil","Loma","Mallige","Meera","mry_KacstQurn","Mukti Narrow","NanumBarunGothic","NanumGothic","NanumMyeongjo","Nimbus Mono L","Nimbus Roman No9 L","Nimbus Sans L","Norasi","OpenSymbol","Padauk","Padauk Book","Phetsarath OT","Pothana2000","Purisa","Rachana","Rekha","Saab","Sawasdee","STIX","STIXGeneral","TakaoPGothic","Tibetan Machine Uni","Tlwg Typist","Tlwg Typo","TlwgMono","TlwgTypewriter","Ubuntu","Ubuntu Condensed","Ubuntu Light","Ubuntu Mono","Umpush","URW Bookman L","URW Chancery L","URW Gothic L","URW Palladio L","utkal","Vemana2000","Waree","WenQuanYi Micro Hei","WenQuanYi Micro Hei Mono","Academy Engraved LET","Apple Color Emoji","AppleGothic","Bangla Sangam MN","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni Ornaments","Bradley Hand","Chalkboard SE","Devanagari Sangam MN","Gujarati Sangam MN","Gurmukhi MN","Heiti SC","Heiti TC","Kailasa","Kannada Sangam MN","Malayalam Sangam MN","Marion","Noteworthy","Oriya Sangam MN","Party LET","Sinhala Sangam MN","Snell Roundhand","Tamil Sangam MN","Telugu Sangam MN"],h=["sans-serif-thin","ARNO PRO","Agency FB","Arabic Typesetting","Arial Unicode MS","AvantGarde Bk BT","BankGothic Md BT","Batang","Bitstream Vera Sans Mono","Calibri","Century","Century Gothic","Clarendon","EUROSTILE","Franklin Gothic","Futura Bk BT","Futura Md BT","GOTHAM","Gill Sans","HELV","Haettenschweiler","Helvetica Neue","Humanst521 BT","Leelawadee","Letter Gothic","Levenim MT","Lucida Bright","Lucida Sans","Menlo","MS Mincho","MS Outlook","MS Reference Specialty","MS UI Gothic","MT Extra","MYRIAD PRO","Marlett","Meiryo UI","Microsoft Uighur","Minion Pro","Monotype Corsiva","PMingLiU","Pristina","SCRIPTINA","Segoe UI Light","Serifa","SimHei","Small Fonts","Staccato222 BT","TRAJAN PRO","Univers CE 55 Medium","Vrinda","ZWAdobeF","DotmetricsFont"],f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t(e,0,[{key:"encode",value:function(t){var i,n,r,a,o,s,c,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(t=e.utf8Encode(t);l<t.length;)a=(i=t.charCodeAt(l++))>>2,o=(3&i)<<4|(n=t.charCodeAt(l++))>>4,s=(15&n)<<2|(r=t.charCodeAt(l++))>>6,c=63&r,isNaN(n)?s=c=64:isNaN(r)&&(c=64),u=u+d.charAt(a)+d.charAt(o)+d.charAt(s)+d.charAt(c);return u}},{key:"utf8Encode",value:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}},{key:"SHA1",value:function(e){function t(e,t){return e<<t|e>>>32-t}function i(e){var t,i="";for(t=7;t>=0;t--)i+=(e>>>4*t&15).toString(16);return i}var n,r,a,o,s,c,d,u,l,h=new Array(80),f=1732584193,m=4023233417,v=2562383102,g=271733878,p=3285377520,S=(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e)).length,y=new Array;for(r=0;r<S-3;r+=4)a=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),y.push(a);switch(S%4){case 0:r=2147483648;break;case 1:r=e.charCodeAt(S-1)<<24|8388608;break;case 2:r=e.charCodeAt(S-2)<<24|e.charCodeAt(S-1)<<16|32768;break;case 3:r=e.charCodeAt(S-3)<<24|e.charCodeAt(S-2)<<16|e.charCodeAt(S-1)<<8|128}for(y.push(r);y.length%16!=14;)y.push(0);for(y.push(S>>>29),y.push(S<<3&4294967295),n=0;n<y.length;n+=16){for(r=0;r<16;r++)h[r]=y[n+r];for(r=16;r<=79;r++)h[r]=t(h[r-3]^h[r-8]^h[r-14]^h[r-16],1);for(o=f,s=m,c=v,d=g,u=p,r=0;r<=19;r++)l=t(o,5)+(s&c|~s&d)+u+h[r]+1518500249&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;for(r=20;r<=39;r++)l=t(o,5)+(s^c^d)+u+h[r]+1859775393&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;for(r=40;r<=59;r++)l=t(o,5)+(s&c|s&d|c&d)+u+h[r]+2400959708&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;for(r=60;r<=79;r++)l=t(o,5)+(s^c^d)+u+h[r]+3395469782&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;f=f+o&4294967295,m=m+s&4294967295,v=v+c&4294967295,g=g+d&4294967295,p=p+u&4294967295}return(l=i(f)+i(m)+i(v)+i(g)+i(p)).toLowerCase()}}])}();function m(e){this.foundVideoPlayers=[],this.SearchForNewVideoPlayersInterval=5e3,this.newVideoFoundCallback=e,this.init=function(){this.trackVideos()},this.trackVideos=function(){this.searchForVideosInWindow(window);var e=window.document.getElementsByTagName("iframe"),t=this;function i(e){var i=!1;try{i=e.contentWindow}catch(n){return}i&&t.searchForVideosInWindow(e.contentWindow)}for(var n=0;n<e.length;n++)i(e[n]);setTimeout((function(){t.trackVideos()}),this.SearchForNewVideoPlayersInterval)},this.searchForVideosInWindow=function(e){try{e.jwplayer}catch(t){return}this.searchForFlowPlayerPlayersInWindow(e),this.searchForJWPlayerPlayersInWindow(e),this.searchForVideoJSPlayersInWindow(e)},this.searchForFlowPlayerPlayersInWindow=function(e){if(e.flowplayer){var t=[],i=0;if(void 0===e.flowplayer.instances)return;for(e.flowplayer.instances.forEach((function(e){t.push(e)})),i=0;i<t.length;i++)this.foundVideoPlayers.indexOf(t[i])<0&&(this.foundVideoPlayers.push(t[i]),this.newVideoFoundCallback("flowPlayer",e.flowplayer.version,t[i]))}},this.searchForJWPlayerPlayersInWindow=function(e){if(e.jwplayer){var t=[],i=e.jwplayer.version;for(n=0;e.jwplayer(n)&&e.jwplayer(n).id;)t.push(e.jwplayer(n)),n++;for(var n=0;n<t.length;n++){for(var r=!0,a=0;a<this.foundVideoPlayers.length;a++)this.foundVideoPlayers[a].id&&this.foundVideoPlayers[a].id==t[n].id&&(r=!1);r&&(this.foundVideoPlayers.push(t[n]),this.newVideoFoundCallback("jwPlayer",t[n].version?t[n].version:i,t[n]))}}},this.searchForVideoJSPlayersInWindow=function(e){if(e.videojs&&"object"==s(e.videojs.players))for(var t in e.videojs.players){var i=e.videojs.players[t];i&&this.foundVideoPlayers.indexOf(i)<0&&(this.foundVideoPlayers.push(i),this.newVideoFoundCallback("videojs",e.videojs.VERSION,i))}}}function v(e,t,n,o){this.urlDecoratedPropertyName="dmid",this.domainsInMeasurement=[],this.Core=e,this.SettingsObject=t,this.domainCookie=n,this.domainCookieTs=o,this.listenForVisitor=function(){if(this.SettingsObject.UrlDecoratorEnabled){var e=this;try{!function(){if(window.location.href.includes(e.urlDecoratedPropertyName)){var t=window.location.href.indexOf(e.urlDecoratedPropertyName);if(!((new Date).getTime()-e.domainCookieTs<d.TIME_STAMP_LIMIT_24_HOURS)){var i=window.location.href.substring(t+e.urlDecoratedPropertyName.length+1,window.location.href.length);e.domainCookie!==i&&e.Core.performAjaxPost(e.Core.baseUrlPrefix+u.DOMAIN_SYNC_URL,{dcd:i,dc:e.domainCookie,ecid:e.SettingsObject.EventChainId})}var n=window.location.href.slice(0,t-1);history.replaceState({},"",n)}}();var t=Array.from(document.querySelectorAll("a")).filter((function(e){return e.href})),n=a(new Set(t.map((function(e){var t;try{if((t=new URL(e.href).hostname).includes("www."))return t.slice(4)}catch(i){return""}return t})).filter((function(e){return e&&e.length})))),o=r(function(){var t=[],i=[],r=DotmetricsJSON.parse(e.Core.getFromLocalStorage("DotmetricsDIM"));if(r)return e.domainsInMeasurement=r.filter((function(e){for(var t in e){if(!0===e[t])return!0;break}return!1})).map((function(e){for(var t in e)return t})),n.forEach((function(e){r.find((function(t){return Object.keys(t)[0]===e}))?i.push(e):t.push(e)})),[t,i];return[n,[]]}(),2),s=o[0],c=o[1];s.length?this.Core.performAjaxPost(e.Core.baseUrlPrefix+u.UIMUrl,{id:e.SettingsObject.SiteSectionId,d:s},(function(t){var r=a(new Set([].concat(a(e.domainsInMeasurement),a(DotmetricsJSON.parse(t)))));e.domainsInMeasurement.length||(e.domainsInMeasurement=r);s=[].concat(a(r),a(c)),o=n.map((function(e){return s.includes(e)?i({},e,!0):i({},e,!1)})),e.Core.saveInLocalStorage({DotmetricsDIM:DotmetricsJSON.stringify(o)}),e.listenForHyperlinkClicks();var o;var s})):e.listenForHyperlinkClicks()}catch(l){e.Core.sendScriptError(l)}}},this.listenForHyperlinkClicks=function(){var e=this;try{window.addEventListener("click",(function(t){e.checkIfHyperlinkAndInjectId(t,e)}))}catch(t){e.Core.sendScriptError(t)}},this.checkIfHyperlinkAndInjectId=function(e,t){try{var i=function(e){if(!e.hasAttribute("href"))return e.closest("a[href]");return e}(e.target),n=i?i.getAttribute("href"):null;n&&!n.includes(window.location.hostname)&&n.includes("http")&&!n.includes("#")&&function(){try{return t.domainsInMeasurement.find((function(e){return e===new URL(n).hostname.replace("www.","")}))}catch(e){return!1}}()&&(n+="#".concat(t.urlDecoratedPropertyName,"=")+encodeURIComponent(t.domainCookie),i.href=n)}catch(r){t.Core.sendScriptError(r)}}}function g(e){function t(e){for(var t={},i=Object.keys(e).sort((function(e,t){return e.localeCompare(t)})),n=0;n<i.length;n++)t[i[n]]=e[i[n]];return t}this.dataSendCount=0,this.pingSendCount=0,this.formPostCount=0,this.SettingsObject=e,this.baseUrlPrefix=this.SettingsObject.BaseUrl,this.isRegExp=function(e){return"[object RegExp]"==Object.prototype.toString.call(e)},this.setCookie=function(e,t,i,n){var r=new Date;r.setDate(r.getDate()+i),n&&r.setMinutes(r.getMinutes()+n);t=escape(t)+(null==i?"":"; expires="+r.toUTCString());document.cookie=e+"="+t+";path=/;secure;"},this.getCookie=function(e){return this.hasCookie(e)?this.listCookie()[e+""]:null},this.hasCookie=function(e){return new RegExp("(?:;\\s*|^)"+encodeURIComponent(e+"")+"=").test(document.cookie)},this.lsAvailable=function(){var e;try{e=window.localStorage;var t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(i){return!1}},this.listCookie=function(e){for(var t,i=document.cookie.split(";"),n={},r=0,a=i.length;r<a;++r)if((t=i[r].split("="))[0]=t[0].replace(/^\s+|\s+$/,""),!this.isRegExp(e)||e.test(t[0]))try{n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}catch(o){}return n},this.sendData=function(e,t){switch(e){case this.baseUrlPrefix+u.DATA_URL:if(this.dataSendCount++,this.dataSendCount>d.CALL_LIMIT)return;break;case this.baseUrlPrefix+u.PING_URL:if(this.pingSendCount++,this.pingSendCount>d.CALL_LIMIT)return}var i="";if(null!=t){var n=f.encode(DotmetricsJSON.stringify(t));i="&v="+(n=encodeURIComponent(n))}var r=e+"?r="+(new Date).getTime()+i,a=document.createElement("script");a.setAttribute("src",r);var o=document.getElementsByTagName("head")[0]||document.head||document.body;try{o.appendChild(a)}catch(c){var s="";try{s=document.documentElement.outerHTML}catch(l){}this.sendScriptError(c,{doc:s})}},this.performAjaxPost=function(e,t,i){var n=f.encode(DotmetricsJSON.stringify(t));n=encodeURIComponent(n);var r=(new Date).getTime(),a="v="+n+"&r="+r;e+="?"+r;var o=new XMLHttpRequest;o.open("POST",e,!0),o.withCredentials=!0,o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i&&o.addEventListener("loadend",(function(){i(o.response)})),o.send(a)},this.performFPPost=function(e,t,i){var n=f.encode(DotmetricsJSON.stringify(t));n=encodeURIComponent(n);var r=(new Date).getTime(),a="v="+n+"&r="+r;e+="?"+r;var o=new XMLHttpRequest;o.open("POST",e,!0),o.withCredentials=!0,o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i&&o.addEventListener("loadend",(function(){i(o.response)})),o.send(a)},this.performSendBeacon=function(e,t){this.sendMessageToExtension({target:"dotmetrics-extension",type:"beacon",url:e,data:t});var i=f.encode(DotmetricsJSON.stringify(t));i=encodeURIComponent(i);var n=(new Date).getTime(),r=new Blob(["v="+i+"&r="+n],{type:"application/x-www-form-urlencoded"});try{return p.boundBeacon(e,r)}catch(a){return!1}},this.addEventSimple=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},this.removeEventSimple=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},this.isIE=function(){return-1!=navigator.appName.indexOf("Microsof")},this.saveInLocalStorage=function(e){if(this.lsAvailable())for(var t in e)e.hasOwnProperty(t)&&window.localStorage.setItem(t+"",e[t])},this.getFromLocalStorage=function(e){return this.lsAvailable()?window.localStorage.getItem(e+""):null},this.removeFromLocalStorage=function(e){return this.lsAvailable()?window.localStorage.removeItem(e+""):null},this.sortByProperty=function(e,t,i){return e.sort((function(e,n){return e[t]<n[t]?"asc"===i?1:-1:e[t]>[t]?"asc"===i?-1:1:0}))},this.CreateElement=function(e,t,i){if(null!=e){var n=document.createElement(e);if(null!=t)for(x in t)"function"==typeof t[x]?this.addEventSimple(n,x,t[x]):(n.setAttribute(x,t[x]),"class"==x&&(n.className=t[x]));if(null!=i){var r=document.createTextNode(i.toString());n.appendChild(r)}return n}return null!=i?document.createTextNode(i.toString()):null},this.clientInfo=null,this.clientInfoTimingData=null,this.createClientInfo=function(e){if(this.clientInfo)e&&e();else{this.clientInfoTimingData={};var t=(new Date).getTime(),i={};i.AppCodeName=window.navigator.appCodeName,i.AppName=window.navigator.appName,i.Version=window.navigator.appVersion,i.Language=window.navigator.language,i.Platform=window.navigator.platform,i.Product=window.navigator.product,i.ProductSub=window.navigator.productSub,i.UserAgent=window.navigator.userAgent,i.Vendor=window.navigator.vendor,i.VendorSub=window.navigator.vendorSub,i.BuildId=window.navigator.buildID,i.OsCpu=window.navigator.oscpu,i.Screen={},i.Screen.AvailableWidth=window.screen.availWidth,i.Screen.AvailableHeight=window.screen.availHeight,i.Screen.PixelDepth=window.screen.pixelDepth,i.Screen.ColorDepth=window.screen.colorDepth;var n=window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI;if(i.Screen.Width=Math.round(window.screen.width*n),i.Screen.Height=Math.round(window.screen.height*n),null==i.Screen.Width&&(i.Screen.Width=i.Screen.AvailableWidth),null==i.Screen.Height&&(i.Screen.Height=i.Screen.AvailableHeight),i.Plugins=[],window.ActiveXObject){var r=/[0-9]+/,a={flash:"ShockwaveFlash.ShockwaveFlash",pdf:"AcroPDF.PDF",silverlight:"AgControl.AgControl",quicktime:"QuickTime.QuickTime"};for(var o in a){var s=this.msieDetect(a[o]);if(s){var c=r.exec(s);s=c&&c[0]||"";var d={};d.Name=a[o],d.FileName="",i.Plugins.push(d)}}}else for(var u=0;u<window.navigator.plugins.length;u++){if(void 0!==(o=window.navigator.plugins[u]))(f={}).Name=o.name,f.FileName=o.filename,i.Plugins.push(f)}i.MimeTypes=[];var h;for(u=0;h=window.navigator.mimeTypes[u];u++){var f;(f={}).Type=h.type,f.Suffixes=h.suffixes,i.MimeTypes.push(f)}t=(new Date).getTime()-t,this.clientInfoTimingData.basicInfoTime=t;var m=(new Date).getTime();i.Canvas=this.CreateCanvasFP(),m=(new Date).getTime()-m,this.clientInfoTimingData.canvasInfoTime=m;var v="",g=new function(){var e=["monospace","sans-serif","serif"],t=document.getElementsByTagName("body")[0],i=document.createElement("span");i.style.fontSize="72px",i.innerHTML="mmmmmmmmmmlli";var n={},r={};for(var a in e)i.style.fontFamily=e[a],t.appendChild(i),n[e[a]]=i.offsetWidth,r[e[a]]=i.offsetHeight,t.removeChild(i);this.detect=function(a){var o=!1;for(var s in e){i.style.fontFamily=a+","+e[s],t.appendChild(i);var c=i.offsetWidth!=n[e[s]]||i.offsetHeight!=r[e[s]];t.removeChild(i),o=o||c}return o}},p=this,S=(u=0,(new Date).getTime());setTimeout((function(){y()}),20)}function y(){var t=g.detect(l[u]);v+=t?"1":"0",++u>=l.length?(i.FontString=v,p.clientInfo=i,S=(new Date).getTime()-S,p.clientInfoTimingData.fontInfoTime=S,e()):setTimeout((function(){y()}),30)}},this.domainFPData=null,this.runDomainFP=function(e){null!=this.domainFPData&&e(this.domainFPData);var t={},i={},n=this,r=(new Date).getTime(),a=0,o=setInterval((function(){a+=c}),100);this.runEdi({callback:function(){var s=f.SHA1(DotmetricsJSON.stringify(t));t.unstable&&(s+="_unstable"),clearInterval(o);var c=(new Date).getTime();i={t:c-r,tInt:a},n.domainFPData={dfp:t,dfph:s.toString(),timingData:i},e(n.domainFPData)},ediDataObject:t,asyncTestList:this.domainFpAsyncTests,syncTestList:this.domainFpSyncTests})};var r=this;this.domainFpSyncTests=[function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.runHasLocalStorageFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.runBluetoothAPI(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createWebglFP(e,t,[{numTriangles:1,vertexData:[-.876,-.65634,0,.8634,-.85673,0,0,.7234,0],colorData:[.986,.12,.55,0,1,0,0,0,1],imageName:"Img1"}])},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createForcedColorsFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createDynamicContrastFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createMonochromaticFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createTransparencyFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createArchitectureFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createMathCalculationsFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createSampleRateFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createMotionFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createColorGamutFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createTouchSupportFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createNavigatorFP(e,t,{testWidth:!1})},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.browserFeaturesFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createWebGlPropertiesFp(e,t)}],this.domainFpAsyncTests=[function(e,t,i){r.runMediaDeviceInfoFp({callback:e,ediDataObject:t,timingDataObject:i,testInfo:!1,testCount:!0})},function(e,t,i){r.createAudioFp("triangle",e,t,i)},function(e,t,i){r.createDomainFontFP({resultProperty:"expFontsOld",testFonts:h,callback:e},t,i)},function(e,t,i){r.createNewCanvasFP({callback:e,ediDataObject:t,timingDataObject:i,options:{renderText:!1,renderGeometry:!0}})},function(e,t,i){r.createPermissionsAndSensorFP(e,t,i)}],this.runEdi=function(e){for(var t=e.callback,i=e.ediDataObject,n=e.timingDataObject,r=void 0===n?{}:n,a=e.asyncTestList,o=e.syncTestList,s=0;s<o.length;s++)o[s](i,r);var c=0;!function e(){c<a.length?setTimeout((function(){a[c](e,i,r),c++}),20):t()}()},this.browserFeaturesFP=function(e,t){var r=(new Date).getTime(),a={style:{elem:document.createElement("dotmetrics")}.elem.style};function o(e){return e.replace(/([a-z])-([a-z])/g,(function(e,t,i){return t+i.toUpperCase()})).replace(/^-/,"")}function c(e,t,i,n,r){var s=e.charAt(0).toUpperCase()+e.slice(1),c=(e+" "+"Moz O ms Webkit".split(" ").join(s+" ")+s).split(" ");return h(t,"string")||h(t,"undefined")?function(e,t,i,n){if(n=!h(n,"undefined")&&n,!h(i,"undefined")){var r=function(e,t){var i=e.length;if("CSS"in window&&"supports"in window.CSS){for(;i--;)if(window.CSS.supports(u(e[i]),t))return!0;return!1}if("CSSSupportsRule"in window){for(var n=[];i--;)n.push("("+u(e[i])+":"+t+")");return n=n.join(" or "),injectElementWithStyles("@supports ("+n+") { #dotmetrics { position: absolute; } }",(function(e){return"absolute"===computedStyle(e,null,"position")}))}return}(e,i);if(!h(r,"undefined"))return r}var s,c,l,f,m,v=["dotmetrics","tspan","samp"];for(;!a.style&&v.length;)s=!0,a.modElem=document.createElement(v.shift()),a.style=a.modElem.style;function g(){s&&(delete a.style,delete a.modElem)}for(l=e.length,c=0;c<l;c++)if(f=e[c],m=a.style[f],d(f,"-")&&(f=o(f)),void 0!==a.style[f]){if(n||h(i,"undefined"))return g(),"pfx"!==t||f;try{a.style[f]=i}catch(p){}if(a.style[f]!==m)return g(),"pfx"!==t||f}return g(),!1}(c,t,n,r):function(e,t,i){var n;for(var r in e)if(e[r]in t)return!1===i?e[r]:h(n=t[e[r]],"function")?l(n,i||t):n;return!1}(c=(e+" "+"Moz O ms Webkit".toLowerCase().split(" ").join(s+" ")+s).split(" "),t,i)}function d(e,t){return!!~(""+e).indexOf(t)}function u(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^ms-/,"-ms-")}function l(e,t){return function(){return e.apply(t,arguments)}}function h(e,t){return s(e)===t}function f(e){var t=document.createElement("video"),i={};try{t.canPlayType&&("video.ogg"===e&&(i["video.ogg"]=t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")),"video.hls"===e&&(i["video.hls"]=t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")))}catch(n){}return t.remove(),i}function m(e){var t=e(),i="";if("object"===s(t))for(var n in t)i+=1==t[n]?"1":"0";else i+=1==t?"1":"0";return i}for(var v=[function(){var e=!1;try{e="SVGFEColorMatrixElement"in window&&2===SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE}catch(t){}return e},function(){return"openDatabase"in window},function(){return f("video.hls")},function(){return"Worker"in window},function(){return"capture"in document.createElement("input")},function(){return f("video.ogg")},function(){return e="search",n=!("onblur"in document),t&&"string"!=typeof t||(t=document.createElement(t||"div")),!(i=(e="on"+e)in t)&&n&&(t.setAttribute||(t=document.createElement("div")),t.setAttribute(e,""),i="function"==typeof t[e],"undefined"!==t[e]&&(t[e]=void 0),t.removeAttribute(e)),i;var e,t,i,n},function(){return c("translate","45px",!0)},function(){return"applicationCache"in window},function(){return c("backdropFilter")},function(){return c("fontVariationSettings")},function(){return"import"in document.createElement("link")},function(){return c("scrollSnapType")},function(){var e=document.createElement("canvas");return{emoji:!!(!!(!!e.getContext&&!!e.getContext("2d"))&&"function"==typeof e.getContext("2d").fillText)&&function(){var t=e.getContext("2d"),i=12*(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1);t.fillStyle="#f00",t.textBaseline="top",t.font="32px Arial",t.fillText("🐨",0,0);var n=t.getImageData(0,0,i,i);return!(!n||!n.data)&&0!==n.data[0]}()}},function(){return!!(Array.prototype&&Array.prototype.copyWithin&&Array.prototype.fill&&Array.prototype.find&&Array.prototype.findIndex&&Array.prototype.keys&&Array.prototype.entries&&Array.prototype.values&&Array.from&&Array.of)},function(){var e=document.createElement("canvas");return{todataurlwebp:function(t){var i=!1;try{i=0===e.toDataURL("image/"+t).indexOf("data:image/"+t)}catch(n){}return i}("webp")}},function(){var e=!1;try{e="WebSocket"in window&&2===window.WebSocket.CLOSING}catch(t){}return e},function(){var e,t=document.createElement("audio");return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t.canPlayType?{"audio.m4a":(e=(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),"function"==typeof e?e():e)}:{})}],g="",p=0;p<v.length;p++)g+=m(v[p]);var S=(new Date).getTime();e.browserFeatures=g,t.browserFeatures=S-r},this.createWebGlPropertiesFp=function(e,t){var i=this;i.startFPTimer();var n=(new Date).getTime();try{var r,a=function(e){try{return e()}catch(t){return""}},o=document.createElement("canvas");o.width=100,o.height=100;try{document.body.appendChild(o)}catch(m){return void f()}for(var s=(r=window.WebGL2RenderingContext&&o.getContext("webgl2",{stencil:!0})?window.WebGL2RenderingContext:window.WebGLRenderingContext)===window.WebGL2RenderingContext?["webgl2","experimental-webgl2"]:["webgl","experimental-webgl"],c=null,d={},u=0;u<s.length;u++)if(c=o.getContext(s[u],{stencil:!0})){s[u];break}if(!c)return void f();d.unMaskedVendor=a((function(){return l(c).vendor})),d.unMaskedRenderer=a((function(){return l(c).renderer})),d.extensions=c.getSupportedExtensions()?a((function(){return c.getSupportedExtensions().join(",")})):"",r===window.WebGL2RenderingContext&&(d.maxCombinedUniformBlocks=c.MAX_COMBINED_UNIFORM_BLOCKS?a((function(){return c.getParameter(c.MAX_COMBINED_UNIFORM_BLOCKS)})):null,d.maxCombinedVertexUniformComponents=c.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS?a((function(){return c.getParameter(c.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)})):null),d.maxViewportDimensions=a((function(){return h(c.getParameter(c.MAX_VIEWPORT_DIMS))})),d.maxCombinedTextureImageUnits=a((function(){return c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS)})),d.maxRenderBufferSize=a((function(){return c.getParameter(c.MAX_RENDERBUFFER_SIZE)})),r===window.WebGL2RenderingContext&&(d.maxTransformFeedbackInterleavedComponents=c.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS?a((function(){return c.getParameter(c.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)})):null,d.max3dTextureSize=c.MAX_3D_TEXTURE_SIZE?a((function(){return c.getParameter(c.MAX_3D_TEXTURE_SIZE)})):null,d.maxArrayTextureLayers=c.MAX_ARRAY_TEXTURE_LAYERS?a((function(){return c.getParameter(c.MAX_ARRAY_TEXTURE_LAYERS)})):null,d.maxSamples=c.MAX_SAMPLES?a((function(){return c.getParameter(c.MAX_SAMPLES)})):null),d.aliasedPointSizeRange=a((function(){return h(c.getParameter(c.ALIASED_POINT_SIZE_RANGE))})),e.webGlProps=DotmetricsJSON.stringify(d),t.webGlTime=(new Date).getTime()-n,t.webGlTimeInt=i.stopFPTimer()}catch(m){i.sendScriptError(m)}function l(e){var t={renderer:"",vendor:""},i=e.getExtension("WEBGL_debug_renderer_info");return null!=i&&(t.renderer=e.getParameter(i.UNMASKED_RENDERER_WEBGL),t.vendor=e.getParameter(i.UNMASKED_VENDOR_WEBGL)),t}function h(e){return"["+e[0]+", "+e[1]+"]"}function f(){o&&o.remove(),e.webGlProps="failed",t.webGlTime=(new Date).getTime()-n,t.webGlTimeInt=i.stopFPTimer()}},this.createNavigatorFP=function(e,t){var i={};i.AvailableHeight=window.screen.availHeight,i.Height=Math.round(window.screen.height*devicePixelRatio),i.UserAgent=window.navigator.userAgent,i.Version=window.navigator.appVersion,i.OsCpu=window.navigator.oscpu,i.ColorDepth=window.screen.colorDepth,i.PixelDepth=window.screen.pixelDepth,t.testWidth&&(e.AvailableWidth=window.screen.availWidth,e.Width=Math.round(window.screen.width*devicePixelRatio)),e.Language=window.navigator.language.split("-")[0],e.navigatorProps=i},this.createPermissionsAndSensorFP=function(e,i,n){var r=this,a=(new Date).getTime();r.startFPTimer();var o={},s=["background-sync","payment-handler","accelerometer","gyroscope","magnetometer","ambient-light-sensor","midi"];try{for(var c=0;c<s.length;c++)l(s[c])}catch(h){this.sendScriptError(h),e()}function d(){var s={},c={absoluteOrientationSensor:function(){var e=!1;"function"==typeof AbsoluteOrientationSensor&&(e=AbsoluteOrientationSensor);u(e,"absoluteOrientationSensor",["accelerometer","gyroscope","magnetometer"])},accelerometer:function(){var e=!1;"function"==typeof Accelerometer&&(e=Accelerometer);u(e,"accelerometer",["accelerometer"])},magnetometer:function(){var e=!1;"function"==typeof Magnetometer&&(e=Magnetometer);u(e,"magnetometer",["magnetometer"])},gyroscope:function(){var e=!1;"function"==typeof Gyroscope&&(e=Gyroscope);u(e,"gyroscope",["gyroscope"])},gravity:function(){var e=!1;"function"==typeof GravitySensor&&(e=GravitySensor);u(e,"gravity",["accelerometer"])},linearAcceleration:function(){var e=!1;"function"==typeof LinearAccelerationSensor&&(e=LinearAccelerationSensor);u(e,"linearAcceleration",["accelerometer"])},relativeOrientation:function(){var e=!1;"function"==typeof RelativeOrientationSensor&&(e=RelativeOrientationSensor);u(e,"relativeOrientation",["accelerometer","gyroscope"])},ambientLight:function(){var e=!1;"function"==typeof AmbientLightSensor&&(e=AmbientLightSensor);u(e,"ambientLight",["ambient-light-sensor"])}};for(var d in c)c[d]();function u(d,u,l){var f={hasReading:!1};if(d)try{var m=function(){clearTimeout(v),g(),f.removeEventListener("reading",m),f.stop()};if(l.every((function(e){return"granted"===o[e]}))){(f=new d({frequency:60})).addEventListener("reading",m),f.start();var v=setTimeout(m,1e3)}else g()}catch(h){g()}else g();function g(){s[u]=f.hasReading,Object.keys(s).length===Object.keys(c).length&&(i.sensors=t(s),i.permissions=t(o),n.sensorsPermissionTiming=(new Date).getTime()-a,n.sensorsPermissionTimingInt=r.stopFPTimer(),e())}}}function u(){Object.keys(o).length===Object.keys(s).length&&d()}function l(e){try{navigator.permissions.query({name:e}).then((function(t){o[e]=t.state,u()})).catch((function(){o[e]="Unsupported",u()}))}catch(h){o[e]="Unsupported",u()}}},this.createNewCanvasFP=function(e){var t=e.callback,i=e.ediDataObject,n=e.timingDataObject,r=e.options,a=this,o=(new Date).getTime();a.startFPTimer();try{!function(e,t,i){var n,r,a=!1,o=document.createElement("canvas");o.width=1,o.height=1;var d=o.getContext("2d");if(!d||!o.toDataURL)return n=r="unsupported",{winding:a,geometry:n,text:r};a=function(e){return e.rect(0,0,10,10),e.rect(2,2,6,6),!e.isPointInPath(5,5,"evenodd")}(d),function(e,t,i,n,r){var a,o,d,u;n&&(s(e,t),setTimeout((function(){a=e.toDataURL(),s(e,t),setTimeout((function(){o=e.toDataURL(),a!==o&&(a="unstable"),l()}),0)}),0));r&&(c(e,t),setTimeout((function(){d=e.toDataURL(),c(e,t),setTimeout((function(){u=e.toDataURL(),d!==u&&(d="unstable"),l()}),0)}),0));function l(){r&&n&&d&&u&&a&&o?i([d,a]):r&&!n&&d&&u?i([d]):n&&!r&&a&&o&&i([a])}}(o,d,(function(t){n=t[0],r=t[1],e({winding:a,geometry:n,text:r})}),t,i)}((function(e){var r=(new Date).getTime()-o;i.canvas={},e.geometry&&(i.canvas.geometry=s(e.geometry));e.text&&(i.canvas.text=s(e.text));function s(e){return"unstable"===e&&(i.unstable=!0),"unstable"===e||"unsupported"===e?e:f.SHA1(e).toString()}i.canvas.winding=e.winding,n.newCanvasTiming=r,n.newCanvasTimingInt=a.stopFPTimer(),t()}),r.renderText,r.renderGeometry)}catch(d){this.sendScriptError(d),t()}function s(e,t){e.width=240,e.height=60,t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(100,1,62,20),t.fillStyle="#069",t.font='11pt "Times New Roman"';var i="The quick brown fox jumps over the lazy dog  /* 😃 */"+String.fromCharCode(55357,56835);t.fillText(i,2,15),t.fillStyle="rgba(102, 204, 0, 0.2)",t.font="18pt Arial",t.fillText(i,4,45)}function c(e,t){e.width=122,e.height=110,t.globalCompositeOperation="multiply";for(var i=[{color:"#f2f",x:40,y:40},{color:"#2ff",x:80,y:40},{color:"#ff2",x:60,y:80}],n=0;n<i.length;n++)t.fillStyle=i[n].color,t.beginPath(),t.arc(i[n].x,i[n].y,40,0,2*Math.PI,!0),t.closePath(),t.fill();t.fillStyle="#f9c",t.arc(60,60,60,0,2*Math.PI,!0),t.arc(60,60,20,0,2*Math.PI,!0),t.fill("evenodd")}},this.createTouchSupportFp=function(e){try{var t=function(){var e,t=0;void 0!==navigator.maxTouchPoints?t=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(t=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),e=!0}catch(n){e=!1}var i="ontouchstart"in window;return{maxTouchPoints:t,touchEvent:e,touchStart:i}}();e.touchSupport={maxTouchPoints:t.maxTouchPoints,touchEvent:t.touchEvent,touchStart:t.touchStart}}catch(i){this.sendScriptError(i)}},this.createColorGamutFp=function(e){try{var t={srgb:window.matchMedia("(color-gamut: srgb)").matches,p3:window.matchMedia("(color-gamut: p3)").matches,rec2020:window.matchMedia("(color-gamut: rec2020)").matches};for(var i in t)if(t[i]){t=i;break}"object"!==s(t)?e.colorGamut=t:e.colorGamut=""}catch(n){this.sendScriptError(n)}},this.createMotionFp=function(e){try{e.motionPreferred=!window.matchMedia("(prefers-reduced-motion: no-preference)").matches}catch(t){this.sendScriptError(t)}},this.createSampleRateFp=function(e){try{if(!window.AudioContext&&!window.webkitAudioContext)return void(e.sampleRate={sampleRate:0,maxChannelCount:0,outputLatency:0});var t=new(window.AudioContext||window.webkitAudioContext);e.sampleRate={sampleRate:t.sampleRate,maxChannelCount:t.destination.maxChannelCount,outputLatency:t.outputLatency}}catch(i){this.sendScriptError(i)}},this.createMathCalculationsFP=function(e){try{var t=function(){return 0},i=function(e){return e||0},n=Math.acos||t,r=Math.acosh||t,a=Math.asin||t,o=Math.asinh||t,s=Math.atanh||t,c=Math.atan||t,d=Math.sin||t,u=Math.sinh||t,l=Math.cos||t,h=Math.cosh||t,f=Math.tan||t,m=Math.tanh||t,v=Math.exp||t,g=Math.expm1||t,p=Math.log1p||t,S={acos:i(n(.12312423423423424)),acosh:i(r(1e308)),asin:i(a(.12312423423423424)),asinh:i(o(1)),atanh:i(s(.5)),atan:i(c(.5)),sin:i(d(-1e300)),sinh:i(u(1)),cos:i(l(10.000000000123)),cosh:i(h(1)),tan:i(f(-1e300)),tanh:i(m(1)),exp:i(v(1)),expm1:i(g(1)),log1p:i(p(10)),powPI:i((D=-100,Math.pow(Math.PI,D))),acoshPf:i(function(e){return Math.log(e+Math.sqrt(e*e-1))}(1e154)),asinhPf:i(function(e){return Math.log(e+Math.sqrt(e*e+1))}(1)),atanhPf:i(function(e){return Math.log((1+e)/(1-e))/2}(.5)),sinhPf:i(function(e){return Math.exp(e)-1/Math.exp(e)/2}(1)),coshPf:i(function(e){return(Math.exp(e)+1/Math.exp(e))/2}(1)),expm1Pf:i(function(e){return Math.exp(e)-1}(1)),tanhPf:i(function(e){return(Math.exp(2*e)-1)/(Math.exp(2*e)+1)}(1)),log1pPf:i(function(e){return Math.log(1+e)}(10))},y=0;for(var w in S)y+=S[w]||0;"number"==typeof y&&Number.isFinite(y)?e.math=y:e.math=0}catch(C){e.math=0,this.sendScriptError(C)}var D},this.createArchitectureFP=function(e){try{var t=new Float32Array(1),i=new Uint8Array(t.buffer);t[0]=1/0,t[0]=t[0]-t[0],e.architecture=i[3]}catch(n){this.sendScriptError(n)}},this.createTransparencyFP=function(e){e.IsTransparencyPreferred=window.matchMedia("(prefers-reduced-transparency)").matches},this.createMonochromaticFP=function(e){e.isMonochromatic=window.matchMedia("(monochrome)").matches},this.createDynamicContrastFP=function(e){e.isHDREnabled=window.matchMedia("(dynamic-range: high)").matches},this.runMediaDeviceInfoFp=function(e){var t=e.callback,i=e.ediDataObject,n=e.timingDataObject,r=e.testInfo,a=e.testCount,o=this,s=(new Date).getTime();if(this.startFPTimer(),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then((function(e){if(r){i.mediaDeviceInfo=[];for(var c=0;c<e.length;c++)i.mediaDeviceInfo.push({deviceId:e[c].deviceId,groupId:e[c].groupId,kind:e[c].kind,label:e[c].label});i.mediaDeviceInfo=o.sortByProperty(i.mediaDeviceInfo,"kind","desc")}n.mediaDeviceInfoTime=(new Date).getTime()-s,n.mediaDeviceInfoTimeInt=o.stopFPTimer(),a&&(i.mediaDeviceInfoCount=function(e){for(var t=[],i=0;i<e.length;i++){for(var n=!1,r=0;r<t.length;r++)t[r].type===e[i].kind&&(n=!0,t[r].count++);n||t.push({type:e[i].kind,count:1})}return o.sortByProperty(t,"type","desc")}(e)),t()}))}catch(c){t(),this.sendScriptError(c)}},this.createAudioFp=function(e,t,i,n){var r,a=!1,o=!0,s=setTimeout((function(){g.removeEventListener("complete",f),r&&clearTimeout(r),u(-2)}),4e3);try{var c,d=this,u=function(r){a||(a=!0,i["audioFp"+e]=r,n["audioFp"+e]=(new Date).getTime()-c,n["audioFp"+e+"Int"]=d.stopFPTimer(),t())},l=function(){var e=0;try{c=(new Date).getTime(),d.startFPTimer(),++e>3&&u(-1),g.startRendering(),o&&(o=!1,h())}catch(i){t(),d.sendScriptError(i)}},h=function(){"suspended"===g.state&&(r=setTimeout((function(){l()}),500))},f=function(e){try{clearTimeout(s),m(e.renderedBuffer)}catch(i){t(),d.sendScriptError(i)}},m=function(e){var t=0;if(e&&e.getChannelData){var i=e.getChannelData(0);if(i.subarray)for(var n=i.subarray(4500),r=0;r<n.length;++r)t+=Math.abs(n[r])}u(t)},v=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(!v)return void u(-2);var g=new v(1,5e3,44100),p=g.createOscillator();p.type=e,p.frequency.value=1e4;var S=g.createDynamicsCompressor();S.threshold.value=-50,S.knee.value=40,S.ratio.value=12,S.attack.value=0,S.release.value=.25,p.connect(S),S.connect(g.destination),p.start(0),g.addEventListener("complete",f),l()}catch(y){t(),this.sendScriptError(y)}},this.msieDetect=function(e){try{var t=new ActiveXObject(e);try{return t.GetVariable("$version")}catch(r){try{return t.GetVersions()}catch(a){try{for(var i,n=1;n<9;n++)t.isVersionSupported(n+".0")&&(i=n);return i||!0}catch(o){return!0}}}}catch(r){return!1}},this.CreateCanvasFP=function(){var e=document.createElement("canvas");if(e.getContext&&e.getContext("2d")){e.width=250,e.height=250;for(var t=e.getContext("2d"),i=0;i<e.width/2;i++)t.moveTo(2*i,0),t.lineTo(4*i,e.height),t.strokeStyle="rgba(0, 0, 0, 0.1)",t.stroke();t.font="40px 'Arial'";for(i=0;i<3;i++)t.fillStyle="#41b4e7",t.fillText("Dotmetrics",10,50*i+75),t.fillStyle="rgba(255, 255, 255, 0.7)",t.fillText("Dotmetrics",20,50*i+75);var n=e.toDataURL("image/jpeg",1);return f.SHA1(n).toString()}return null},this.runHasLocalStorageFp=function(e){e.hasLocalStorage=this.lsAvailable()},this.runBluetoothAPI=function(e){e.bluetoothAPI=!!window.navigator.bluetooth},this.createWebglFP=function(e,t,i){function n(i){var n,r,a=i.numTriangles,o=i.vertexData,s=i.colorData,c=i.imageName,d=(new Date).getTime();(n=document.createElement("canvas")).width=256,n.height=128,r=n.getContext("webgl2")||n.getContext("experimental-webgl2")||n.getContext("webgl")||n.getContext("experimental-webgl")||n.getContext("moz-webgl");var u=null;try{var l=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,l);var h=new Float32Array(o);r.bufferData(r.ARRAY_BUFFER,h,r.STATIC_DRAW),l.itemSize=3,l.numItems=a;var m=new Float32Array(s),v=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,v),r.bufferData(r.ARRAY_BUFFER,m,r.STATIC_DRAW),v.itemSize=3,v.numItems=a;var g=r.createProgram(),p=r.createShader(r.VERTEX_SHADER);r.shaderSource(p,"attribute vec3 attrVertex;attribute vec3 color;varying vec3 vColor;void main(){gl_Position=vec4(attrVertex,1);vColor=color;}"),r.compileShader(p);var S=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(S,"precision mediump float;varying vec3 vColor;void main(){gl_FragColor=vec4(vColor,1);}"),r.compileShader(S),r.attachShader(g,p),r.attachShader(g,S),r.linkProgram(g),r.useProgram(g),r.bindBuffer(r.ARRAY_BUFFER,l),g.vertexPosAttrib=r.getAttribLocation(g,"attrVertex"),g.offsetUniform=r.getUniformLocation(g,"uniformOffset"),r.enableVertexAttribArray(g.vertexPosArray),r.vertexAttribPointer(g.vertexPosAttrib,l.itemSize,r.FLOAT,!1,0,0),r.uniform2f(g.offsetUniform,1,1),r.bindBuffer(r.ARRAY_BUFFER,v);var y=r.getAttribLocation(g,"color");r.enableVertexAttribArray(y),r.vertexAttribPointer(y,v.itemSize,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLES,0,3*l.numItems);var w=n.toDataURL("image/jpeg",1);u=f.SHA1(w).toString()}catch(C){}var D=(new Date).getTime();e["webglFp"+c]=u,t["webglFp"+c]=D-d}for(var r=0;r<i.length;r++)n(i[r])},this.createDomainFontFP=function(e,t,i){var n=e.resultProperty,r=e.testFonts,a=e.callback,o=this.createFontTestIframe();try{o.onload=function(){var e=["monospace","sans-serif","serif"],i="thequickbrownfoxjumpsoverthelazydogTHEQUICKBROWNFOXJUMPSOVERTHELAZYDOG0123456789#&!?",s=o.contentDocument.body;s.style.fontSize="72px";var c=o.contentDocument.createElement("div");c.style.setProperty("visibility","hidden","important");var d={},u={};function l(e){var t=o.contentDocument.createElement("span");return t.style="position: absolute; top: 0; left: 0; font-family: "+e+";",t.textContent=i,c.appendChild(t),t}function h(e,t){return l(e+","+t)}function f(t){for(var i=!1,n=0;n<e.length;n++)t[n].offsetWidth===d[e[n]]&&t[n].offsetHeight===u[e[n]]||(i=!0);return i}var m=function(){for(var t={},i=0;i<e.length;i++)t[e[i]]=l(e[i]);return t}(),v=function(){for(var t={},i=0;i<r.length;i++)t[r[i]]=e.map((function(e){return h(r[i],e)}));return t}();s.appendChild(c),setTimeout((function(){for(var i=0;i<e.length;i++)d[e[i]]=m[e[i]].offsetWidth,u[e[i]]=m[e[i]].offsetHeight;var s="";for(i=0;i<r.length;i++){var c=r[i];s+=f(v[c])?"1":"0"}"1"===s[s.length-1]&&(t.unstable=!0),t[n]=s,document.body.removeChild(o),a()}),0)}}catch(s){this.sendScriptError(s),document.body.removeChild(o)}},this.createForcedColorsFP=function(e,t){var i=(new Date).getTime(),n=window.matchMedia("(forced-colors: active)").matches,r=(new Date).getTime();e.forcedColors=n,t.forcedColors=r-i},this.createFontTestIframe=function(){var e=document.createElement("iframe");return e.style.display="block !important",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.visibility="hidden",e.srcdoc='<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1">',document.body.appendChild(e),e};var a=0,o=null,c=100;this.startFPTimer=function(){a=0,o=setInterval((function(){a+=c}),c)},this.stopFPTimer=function(){return clearInterval(o),a},this.getNetworkInformation=function(){var e=null;try{if(void 0!==window.navigator.connection){var t=window.navigator.connection;e={et:t.effectiveType,dl:t.downlink,dlm:t.downlinkMax,rtt:t.rtt,sd:t.saveData,t:t.type}}}catch(i){this.sendScriptError(i)}return e},this.CreateElement=function(e,t,i){if(null!=e){var n=document.createElement(e);if(null!=t)for(var r in t)"function"==typeof t[r]?this.addEventSimple(n,r,t[r]):(n.setAttribute(r,t[r]),"class"==r&&this.isIE()&&(n.className=t[r]));if(null!=i){var a=document.createTextNode(i.toString());n.appendChild(a)}return n}return null!=i?document.createTextNode(i.toString()):null},this.sendMessageToExtension=function(e,t){window.sendMessageToDotmetricsExtension&&window.sendMessageToDotmetricsExtension(e,t)},this.postMessage=function(e,t){try{void 0!==t?t.postMessage(e,"*"):window.postMessage(e,"*")}catch(i){}};var m=!1;this.sendScriptError=function(e,t){if(!m){m=!0;var i={type:"script",ecid:this.SettingsObject.EventChainId,details:t||{},name:e&&e.name?e.name:"",message:e&&e.message?e.message:"",stack:e&&e.stack?e.stack:"",sectionId:this.SettingsObject.SiteSectionId,pageUrl:window.location.href};this.performAjaxPost(this.baseUrlPrefix+u.ERROR_EVENT_URL,i)}},this.findMedian=function(e){e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2==0?(e[t-1]+e[t])/2:e[t]},this.calculateMADMedian=function(e){for(var t=this.findMedian(e),i=[],n=0;n<e.length;n++)i.push(Math.abs(e[n]-t));return this.findMedian(i)}}"object"!==s(window.DotmetricsJSON)&&(window.DotmetricsJSON=window.JSON);var p=new function(){this.SettingsObject=window.DotMetricsSettings,this.boundBeacon=navigator.sendBeacon.bind(navigator),this.Core=new g(this.SettingsObject),this.EnterPageEventData=null,this.TimeOnPage=0,this.LastSentTimeOnPage=-1,this.TimeBuffer=0,this.LoadTimeStamp="",this.surveyLink="",this.DeviceId=null,this.UserId=null,this.DeviceGuidId=null,this.deviceInfoSent=!1,this.postIndex=0,this.Done=!1,this.surveyDone=!1,this.ajaxTimer=null,this.panel=!1,this.panelUserId=null,this.panelHouseholdId=null,this.videos={},this.foundVideoPlayers=[],this.timeBufferIntervalInstanceId=null,this.saveTimeOnPageIntervalFunctionId=null,this.lastInteraction=null,this.domainCookie=this.SettingsObject.DomainCookieData.value,this.domainCookieTs=this.SettingsObject.DomainCookieData.ts,this.domainCookieChanged=this.SettingsObject.DomainCookieData.changed,this.scriptVersion=this.SettingsObject.ScriptVersion,this.domainFphObject=null,this.domainFph=null,this.Start=function(){var e=this;if("https://"===String(e.Core.baseUrlPrefix).slice(0,8))try{this.domainFphObject=this.getDomainFpObjectFromStorage(),this.domainFph=null==this.domainFphObject?"":this.domainFphObject.dfph,this.urlDecorator=new v(this.Core,this.SettingsObject,this.domainCookie,this.domainCookieTs),this.urlDecorator.listenForVisitor(),document.addEventListener("visibilitychange",(function(){try{if("hidden"===document.visibilityState){e.stopIntervalFunctions(),e.emptyTimeBuffer();var t=e.SendTimeOnPageBeacon();e.SaveTimeOnPage(t)}else"visible"===document.visibilityState&&e.startIntervalFunctions()}catch(i){e.Core.sendScriptError(i)}})),e.startIntervalFunctions(),this.initPanelElements(),this.initInteractionEvents(),this.listenForExtensionMessages();var t=this.createStartData();e.Core.sendData(this.Core.baseUrlPrefix+u.DATA_URL,t),window.dm&&this.onAjaxDataUpdate(),1==this.SettingsObject.VideoTrackingEnabled&&this.trackVideos()}catch(i){e.Core.sendScriptError(i)}},this.listenForExtensionMessages=function(){var e=this;window.addEventListener("message",(function(t){t.data.source&&"dotmetrics-extension"==t.data.source&&t.data.type&&e.handleExtensionRequest(t.data.type,t.source)}))},this.handleExtensionRequest=function(e,t){switch(e){case"timeOnPage":var i=this.createCurrentTimeOnPageObject();(n=this.getTimeOnPageDataTemplate()).ep.push(i),this.Core.sendMessageToExtension({target:"dotmetrics-extension",type:"timeOnPage",data:n},t);break;case"getEnterPageData":var n;if(this.EnterPageEventData)(n=JSON.parse(JSON.stringify(this.EnterPageEventData))).ecid=this.SettingsObject.EventChainId,n.dc=this.domainCookie,n.ver=this.scriptVersion,n.dfp=this.domainFph,this.Core.postMessage({target:"dotmetrics-plugin",type:"enterPageData",data:n},t);break;case"getDeviceInfo":var r=this;this.Core.createClientInfo((function(){var e={deviceInfo:r.Core.clientInfo,deviceHash:f.SHA1(DotmetricsJSON.stringify(r.Core.clientInfo)),clientInfoTimingData:r.Core.clientInfoTimingData};r.Core.postMessage({target:"dotmetrics-extension",type:"deviceInfo",data:e},t)}));break;case"generateDiData":r=this;window.console.log("generating di data"),this.Core.runDomainFP((function(e){window.console.log("postMessage di data",e),r.Core.postMessage({target:"dotmetrics-extension",type:"diData",data:e},t)}))}},this.createStartData=function(){var e=(new Date).getTimezoneOffset(),t={id:this.SettingsObject.SiteSectionId,fl:!0,dom:window.location.hostname,lso:null,url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,tzOffset:e};this.panel&&(t.hhid=this.panelHouseholdId,t.uid=this.panelUserId);var i="DM_SitId"+this.SettingsObject.SiteId,n="DM_SitIdT"+this.SettingsObject.SiteId,r=i+"SecId"+this.SettingsObject.SiteSectionId,a=i+"SecIdT"+this.SettingsObject.SiteSectionId,o=this.Core.getFromLocalStorage("DotmetricsSiteData");try{o=o?DotmetricsJSON.parse(o):{}}catch(l){o={}}var s=(new Date).getTime()-18e5;for(var c in o)o[c]<s&&delete o[c];this.Core.hasCookie(i)&&o.hasOwnProperty(n)?t.oss=!1:(this.Core.setCookie(i,"1"),t.oss=!0),this.Core.hasCookie(r)&&o.hasOwnProperty(a)?t.oses=!1:(this.Core.setCookie(r,"1"),t.oses=!0);var d=(new Date).getTime();o[n]=d,o[a]=d;var u={DotmetricsSiteData:JSON.stringify(o)};return this.Core.saveInLocalStorage(u),t},this.processActions=function(e){try{var t=this,i=(new Date).getTimezoneOffset(),n={id:this.SettingsObject.SiteSectionId,fl:!1,dom:window.location.hostname,lso:null,ds:null,dsl:null,dh:null,url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,tzOffset:i};this.panel&&(n.hhid=this.panelHouseholdId,n.uid=this.panelUserId);var r=!1;if(e.SendDeviceInfo||e.Ping){var a={deviceInfo:!1,pings:0,exitPageData:!1};e.Ping&&e.Ping>0&&0==this.deviceInfoSent&&(a.pings=e.Ping),e.SendDeviceInfo&&0==this.deviceInfoSent&&(a.deviceInfo=!0,this.deviceInfoSent=!0),this.submitData(a)}if(e.Survey&&e.Survey.SurveyUrl)if(e.Survey,this.Survey=e.Survey,this.Survey.Mobile){var o=this;this.anchor=this.Core.CreateElement("a",{href:e.Survey.SurveyUrl,style:"position:fixed; width:100%; height:100%; top:0; left:0; background:#f00; opacity:0;z-index:99999",target:"_blank",id:"DotMetricsPopupLink"},null),document.body.appendChild(this.anchor),this.Core.addEventSimple(this.anchor,"click",(function(e){try{e.preventDefault();var t=o.anchor.getAttribute("href"),i=o.anchor.parentElement;if(i&&i.removeChild(o.anchor),o.surveyDone)return;o.surveyDone=!0,setTimeout((function(){window.open(t,"_blank")}),20)}catch(n){o.Core.sendScriptError(n)}}))}else{var s=function(){try{document.body.addEventListener?document.body.removeEventListener("click",s):document.body.detachEvent("onclick",s),t.showSurvey()}catch(e){t.Core.sendScriptError(e)}};document.body.addEventListener?document.body.addEventListener("click",s,!1):document.body.attachEvent("onclick",s)}if(e.SendDeviceHash){if(!this.Core.clientInfo)return void this.Core.createClientInfo((function(){t.processActions(e)}));var c=DotmetricsJSON.stringify(this.Core.clientInfo),d=f.SHA1(c);n.dh=d.toString(),n.dh,r=!0}if(e.PersistDeviceAndUser&&e.DeviceId&&e.UserId&&e.DeviceGuidId&&this.Core.saveInLocalStorage({DotMetricsDeviceId:e.DeviceId,DotMetricsUserId:e.UserId,DotMetricsDeviceGuidId:e.DeviceGuidId}),e.SendLSO){var l=this.Core.getFromLocalStorage("DotMetricsUserId"),h=this.Core.getFromLocalStorage("DotMetricsDeviceId"),m=this.Core.getFromLocalStorage("DotMetricsDeviceGuidId");n.lso=l&&h&&m?{d:h,u:l,dg:m}:{d:"",u:"00000000-0000-0000-0000-000000000000",dg:"00000000-0000-0000-0000-000000000000"},r=!0}r&&t.Core.sendData(t.Core.baseUrlPrefix+u.DATA_URL,n)}catch(v){this.Core.sendScriptError(v)}},this._timeData=[],this._pingRawData=[],this._currentRequestNum=0,this._requestedPingsNum=0,this._onPingMeasurmentsDone=null,this._pingStartTime=0,this._pingPorcessRunning=!1,this._pingProcessQueue=[],this.measurePingTimes=function(e,t){try{if(1==this._pingPorcessRunning){var i=this;return void this._pingProcessQueue.push((function(){i.measurePingTimes(e,t)}))}this._pingPorcessRunning=!0,this._timeData=[],this._pingRawData=[],this._currentRequestNum=0,this._requestedPingsNum=e,this._onPingMeasurmentsDone=t,this.makePingRequest()}catch(n){this.Core.sendScriptError(n)}},this.makePingRequest=function(){this._pingStartTime=(new Date).getTime(),(0==this._timeData.length?{ctd:0,cl:0}:this._timeData[this._timeData.length-1]).ct=this._pingStartTime,this._pingRawData.push({ct:this._pingStartTime}),this.Core.sendData(this.Core.baseUrlPrefix+u.PING_URL,null)},this.HandlePing=function(e){try{var t=(new Date).getTime(),i=(t-this._pingStartTime)/2,n=this._pingStartTime-e.s-Math.abs(i),r={ctd:n,cl:i},a=this._pingRawData.length-1;if(this._pingRawData[a].cte=t,this._pingRawData[a].s=e.s,this._pingRawData[a].ctd=n,this._pingRawData[a].cl=i,this._timeData.push(r),this._currentRequestNum++,this._currentRequestNum<this._requestedPingsNum)this.makePingRequest();else{for(var o=0,s=0,c=[],d=[],u=0;u<this._timeData.length;u++)o+=this._timeData[u].ctd,s+=this._timeData[u].cl,c.push(this._timeData[u].ctd),d.push(this._timeData[u].cl);e={DeviceSync:o=Math.round(o/this._timeData.length),DeviceSyncLag:s=Math.round(s/this._timeData.length),DeviceSyncMedian:Math.round(this.Core.findMedian(c)),DeviceSyncLagMedian:Math.round(this.Core.findMedian(d)),DeviceSyncMAD:Math.round(this.Core.calculateMADMedian(c)),DeviceSyncLagMAD:Math.round(this.Core.calculateMADMedian(d)),raw:this._pingRawData};if(this._timeData,this._onPingMeasurmentsDone(e),this._pingPorcessRunning=!1,this._pingProcessQueue.length>0)this._pingProcessQueue.shift()()}}catch(l){this.Core.sendScriptError(l)}},this.showSurvey=function(){if(!this.surveyDone){this.surveyDone=!0;var e=this.Survey.WindowWidth,t=this.Survey.WindowHeight;window.open(this.Survey.SurveyUrl,"","width="+e+",height="+t+",scrollbars=1").focus()}},this.startIntervalFunctions=function(){var e=this;null==this.timeBufferIntervalInstanceId&&(this.timeBufferIntervalInstanceId=setInterval((function(){try{null!=document.visibilityState?"visible"==document.visibilityState&&e.TimeBuffer++:e.TimeBuffer++}catch(t){e.Core.sendScriptError(t)}}),1e3)),null==this.saveTimeOnPageIntervalFunctionId&&(this.saveTimeOnPageIntervalFunctionId=setInterval((function(){e.SaveTimeOnPage()}),d.SAVE_TIME_ON_PAGE_INTERVAL))},this.stopIntervalFunctions=function(){this.timeBufferIntervalInstanceId&&(clearInterval(this.timeBufferIntervalInstanceId),this.timeBufferIntervalInstanceId=null),this.saveTimeOnPageIntervalFunctionId&&(clearInterval(this.saveTimeOnPageIntervalFunctionId),this.saveTimeOnPageIntervalFunctionId=null)},this.emptyTimeBuffer=function(){try{(new Date).getTime()-this.lastInteraction.getTime()<=d.TIME_THRESHOLD&&(this.TimeOnPage+=this.TimeBuffer),this.TimeBuffer=0,this.lastInteraction=new Date}catch(e){this.Core.sendScriptError(e)}},this.SendTimeOnPageBeacon=function(){if(this.LastSentTimeOnPage==this.TimeOnPage)return!0;if(navigator.sendBeacon&&this.EnterPageEventData){var e=this.createCurrentTimeOnPageObject(),t=this.getTimeOnPageDataTemplate();return t.ep.push(e),this.LastSentTimeOnPage=this.TimeOnPage,this.Core.performSendBeacon(this.Core.baseUrlPrefix+u.BEACON_URL,t)}return!1},this.createCurrentTimeOnPageObject=function(){return{cd:this.EnterPageEventData.CreationDate,eid:this.EnterPageEventData.EventId,id:this.EnterPageEventData.SiteSectionId,sop:this.TimeOnPage,vl:this.getVideoData(),url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph}},this.getTimeOnPageDataTemplate=function(){var e=(new Date).getTimezoneOffset(),t={id:this.SettingsObject.SiteSectionId,cd:{d:this.DeviceId,u:this.UserId,dg:this.DeviceGuidId},ep:[],tzOffset:e};return this.panel&&(t.hhid=this.panelHouseholdId,t.uid=this.panelUserId),t},this.SaveTimeOnPage=function(e){try{if(0==this.Core.lsAvailable())return;if(null==this.EnterPageEventData)return;for(var t=this.getTimeOnPageData(),i=0;i<t.length;i++)if(t[i].eid==this.EnterPageEventData.EventId){t.splice(i,1);break}if(!e){var n=this.createCurrentTimeOnPageObject();t.push(n)}t.length>d.MAX_TIME_ON_PAGE_ITEMS_IN_LOCAL_STORAGE&&t.splice(0,t.length-d.MAX_TIME_ON_PAGE_ITEMS_IN_LOCAL_STORAGE);var r={};r[this.SettingsObject.TimeOnPage]=DotmetricsJSON.stringify(t),this.Core.saveInLocalStorage(r)}catch(a){this.Core.sendScriptError(a)}},this.processTimeOnPageData=function(){try{if(0==this.Core.lsAvailable())return null;for(var e=[],t=this.getTimeOnPageData(),i=new Date,n=0;n<t.length;n++)try{var r=t[n],a=new Date(r.cd);i.getTime()-a.getTime()<864e5&&e.push(r)}catch(o){}return 0==e.length&&(e=null),this.Core.removeFromLocalStorage(this.SettingsObject.TimeOnPage),e}catch(o){this.Core.sendScriptError(o)}},this.getTimeOnPageData=function(){try{var e=this.Core.getFromLocalStorage(this.SettingsObject.TimeOnPage),t=[];if(null!=e&&e.length>0)try{t=DotmetricsJSON.parse(e)}catch(i){t=JSON.parse(e)}return t}catch(i){return this.Core.sendScriptError(i),[]}},this.initInteractionEvents=function(){this.lastInteraction=new Date;var e=this;this.Core.addEventSimple(document,"mousemove",(function(){e.emptyTimeBuffer()})),this.Core.addEventSimple(document,"wheel",(function(){e.emptyTimeBuffer()})),this.Core.addEventSimple(document,"touchend",(function(){e.emptyTimeBuffer()}))},this.initPanelElements=function(){if(document.getElementById("DotmetricsPanelUserId")&&document.getElementById("DotmetricsPanelHouseholdId")){this.panel=!0,this.panelUserId=document.getElementById("DotmetricsPanelUserId").value,this.panelHouseholdId=document.getElementById("DotmetricsPanelHouseholdId").value;var e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("id","DotmetricsScriptLoaded"),e.setAttribute("value","true"),document.getElementsByTagName("head")[0].appendChild(e)}},this.CreateIframe=function(){this.iFrameHolderDiv=this.Core.CreateElement("div",{id:"DotMetricsPF",style:"display:none;width:0px;height:0px;position:absolute; left:-2000px;"},null);var e="dotmetricsframe"+this.postIndex;this.postIndex++,this.iFrameHolderDiv.style.display="none";try{this.iframe=document.createElement('<iframe name="'+e+'" style:"display:none;width:0px;height:0px;">')}catch(t){this.iframe=this.Core.CreateElement("iframe",{name:e,id:e,style:"display:none;width:0px;height:0px;"},null)}this.iframe.id=e,this.form=this.Core.CreateElement("form",{action:this.Core.baseUrlPrefix+u.POST_URL,method:"post",target:e,id:"DotMetricsForm"},null),this.formInput=this.Core.CreateElement("input",{type:"text",name:"v"},null),document.body.appendChild(this.iFrameHolderDiv),this.iFrameHolderDiv.appendChild(this.iframe),this.iFrameHolderDiv.appendChild(this.form),this.form.appendChild(this.formInput),document.getElementById("DotMetricsForm").target=e},this.submitData=function(e){var t=this;if(this.Core.formPostCount++,!(this.Core.formPostCount>d.CALL_LIMIT)){var i=(new Date).getTimezoneOffset(),n={id:this.SettingsObject.SiteSectionId,cd:{d:this.DeviceId,u:this.UserId,dg:this.DeviceGuidId},di:null,ds:0,dsl:0,url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,tzOffset:i};if(this.panel&&(n.hhid=this.panelHouseholdId,n.uid=this.panelUserId),e.deviceInfo){if(!this.Core.clientInfo)return void this.Core.createClientInfo((function(){t.submitData(e)}));n.di=this.Core.clientInfo}e.pings>0?this.measurePingTimes(e.pings,(function(e){n.ds=e.DeviceSync,n.dsl=e.DeviceSyncLag,r()})):r()}function r(){try{t.CreateIframe(),t.formInput.value=DotmetricsJSON.stringify(n),t.form.submit();var e=t.iFrameHolderDiv;setTimeout((function(){document.body.removeChild(e)}),5e3)}catch(i){t.Core.sendScriptError(i)}}},this.HandleJsonp=function(e){try{var t=this;if(t.Core.sendMessageToExtension({target:"dotmetrics-extension",type:"jsonpResponse",data:e,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph}),this.UserId=e.UserId,this.DeviceId=e.DeviceId,this.DeviceGuidId=e.DeviceGuidId,window.DotMetricsObj.DeviceId=this.DeviceId,window.DotMetricsObj.UserId=this.UserId,this.deviceInfoSent&&(e.SendDeviceInfo=!1,e.Ping=0),this.firstLoadDone)this.processActions(e);else{this.firstLoadDone=!0,this.EnterPageEventData=e.EnterPageEventData,window.DotMetricsObj.firstLoadDone=!0,window.DotMetricsObj.EnterPageEventData=e.EnterPageEventData,this.runDomainFPProcess();var i={deviceInfo:!1,pings:0};1==e.SendDeviceInfo&&0==this.deviceInfoSent&&(i.deviceInfo=!0,e.SendDeviceInfo=!1,this.deviceInfoSent=!0),e.Ping&&e.Ping>0&&(i.pings=e.Ping,e.Ping=!1),setTimeout((function(){try{(i.deviceInfo||i.pings)&&t.submitData(i);var n=t.processTimeOnPageData();if(t.Core.setCookie(t.SettingsObject.TimeOnPage,null,0),n){var r=t.getTimeOnPageDataTemplate();r.ep=n,t.Core.performAjaxPost(t.Core.baseUrlPrefix+u.BEACON_URL,r)}t.processActions(e)}catch(a){t.Core.sendScriptError(a)}}),1e3*Math.random()+500)}}catch(n){this.Core.sendScriptError(n)}},this.getDomainFpObjectFromStorage=function(){var e,t;try{e=JSON.parse(this.Core.getFromLocalStorage(d.DOMAIN_FPH_KEY))}catch(i){e=null}try{t=JSON.parse(this.Core.getCookie(d.DOMAIN_FPH_KEY))}catch(i){t=null}return this.syncDomainFpObject(e,t)},this.syncDomainFpObject=function(e,t){var i=this.checkIfDomainFpValid(e),n=this.checkIfDomainFpValid(t),r=null;if(i&&n?r=e.time>t.time?e:t:i?r=e:n&&(r=t),null!=r){var a=JSON.stringify(r),o={};o[d.DOMAIN_FPH_KEY]=a,this.Core.saveInLocalStorage(o),this.Core.setCookie(d.DOMAIN_FPH_KEY,a,365)}return r},this.checkIfDomainFpValid=function(e){return!!(void 0!==e&&null!=e&&null!=e.dfph&&""!=e.dfph&&(40==e.dfph.length||e.dfph.indexOf("_unstable")>0)&&e.v&&e.time&&e.niTime)},this.runDomainFPProcess=function(){var e=!1;if(!(0==this.SettingsObject.DomainCookieEnabled||(new Date).getTime()-this.domainCookieTs<d.TIME_STAMP_LIMIT_24_HOURS)){var t=this.domainFphObject,i=t&&t.dfph?t.dfph:null,n=t&&t.time?t.time:0;if(e=!(!t||10===t.v)||(new Date).getTime()-n>d.TIME_STAMP_LIMIT_5_DAYS,0!=(1==this.domainCookieChanged||1==e||null==i)){var r=this;this.Core.runDomainFP((function(e){try{var t={dfph:e.dfph,time:(new Date).getTime(),niTime:(new Date).getTime(),v:10},i={id:r.SettingsObject.SiteSectionId,ecid:r.SettingsObject.EventChainId,eid:r.EnterPageEventData.EventId,dc:r.domainCookie,ver:r.scriptVersion,dfph:e.dfph};r.runNetworkMeasurements((function(n){i.ts=n.ts,i.ni=n.ni,r.Core.performFPPost(r.Core.baseUrlPrefix+u.EDI_URL,i,(function(n){try{"OK"==n?r.syncDomainFpObject(t):(i.dfp=e.dfp,i.td=e.timingData,r.Core.performFPPost(r.Core.baseUrlPrefix+u.EDI_URL,i,(function(e){"OK"==e&&r.syncDomainFpObject(t)})))}catch(a){r.Core.sendScriptError(a)}}))}))}catch(n){r.Core.sendScriptError(n)}}))}else this.runDailyEdi(t)}},this.runDailyEdi=function(e){if(this.checkIfDomainFpValid(e)&&e.time&&e.niTime){var t=new Date,i=new Date(e.time),n=new Date(e.niTime);if(t.getDate()==i.getDate()||t.getDate()==n.getDate())return;var r=this;this.runNetworkMeasurements((function(t){if(!(t.ts.dlm>1e3)){var i={id:r.SettingsObject.SiteSectionId,ecid:r.SettingsObject.EventChainId,eid:r.EnterPageEventData.EventId,dc:r.domainCookie,ver:r.scriptVersion,dfph:e.dfph,ts:t.ts,ni:t.ni};r.Core.performFPPost(r.Core.baseUrlPrefix+u.EDI_DAILY_URL,i),e.niTime=(new Date).getTime(),r.syncDomainFpObject(e)}}))}},this.runNetworkMeasurements=function(e){var t=this;this.measurePingTimes(5,(function(i){var n={};n.ts={dsa:i.DeviceSync,dsm:i.DeviceSyncMedian,dsmad:i.DeviceSyncMAD,dla:i.DeviceSyncLag,dlm:i.DeviceSyncLagMedian,dlmad:i.DeviceSyncLagMAD,raw:i.raw},n.ni=t.Core.getNetworkInformation(),e(n)}))},this.onAjaxDataUpdate=function(){try{var e=window.dm,t=this;if("https://"!==String(t.Core.baseUrlPrefix).slice(0,8))return;null==this.ajaxTimer&&void 0!==e&&void 0!==e.AjaxData&&e.AjaxData.length>0&&(this.ajaxTimer=setTimeout((function(){try{t.cloneAjaxDataForStressTestScript(e.AjaxData);var i=t.prepareAjaxData(e.AjaxData);e.AjaxData.length=0,t.ajaxTimer=null,t.Core.performAjaxPost(t.Core.baseUrlPrefix+u.AJAX_EVENT_URL,i)}catch(n){t.Core.sendScriptError(n)}}),this.SettingsObject.AjaxEventTimeout))}catch(i){this.Core.sendScriptError(i)}},this.cloneAjaxDataForStressTestScript=function(e){try{var t="dmStress";if(void 0!==window.DotMetricsObjStress){var i=JSON.parse(JSON.stringify(e));void 0===window[t]&&(window[t]={AjaxData:[]});for(var n=0;n<i.length;n++)window[t].AjaxData.push(i[n]);window.DotMetricsObjStress.onAjaxDataUpdate()}}catch(r){}},this.prepareAjaxData=function(e){var t=(new Date).getTimezoneOffset(),i={siteSectionId:this.SettingsObject.SiteSectionId,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,domain:window.location.hostname,events:[],tzOffset:t};this.panel&&(i.hhid=this.panelHouseholdId,i.uid=this.panelUserId);var n=this;return e.forEach((function(e){var t={};e.et?t.eventType=e.et:t.eventType="pageview",e.d?t.eventData=e.d:t.eventData=null,e.ssid?t.eventSiteSectionId=e.ssid:t.eventSiteSectionId=n.SettingsObject.SiteSectionId,isNaN(t.eventSiteSectionId)&&(t.eventTag=t.eventSiteSectionId,delete t.eventSiteSectionId),e.url?t.url=e.url:t.url=window.location.href,i.events.push(t)})),i},this.trackVideos=function(){var e=this;new m((function(t,i,n){switch(t){case"flowPlayer":e.trackFP(n,t,i);break;case"jwPlayer":e.trackJW(n,t,i);break;case"videojs":e.trackVideoJS(n,t,i)}})).init()};var e=!1;this.sendVideoError=function(t,i,n){if(!e){e=!0;var r={};n&&n.name&&(r.name=n.name),n&&n.message&&(r.message=n.message),n&&n.stack&&(r.stack=n.stack);var a={type:"video",details:{player:t,playerVersion:i},error:r,sectionId:this.SettingsObject.SiteSectionId,pageUrl:window.location.href};this.Core.performAjaxPost(this.Core.baseUrlPrefix+u.ERROR_EVENT_URL,a)}},this.trackFP=function(e,t,i){var n=this,r=null,a=null;function o(){var t="";try{t=e.opts.title}catch(n){}var i=e.currentSrc;return"".concat(i,"_").concat(t)}function s(){var t="";try{t=e.opts.title}catch(c){}var i=Math.max(0,e.duration),s=o();n.videos[s]={vid:e.currentSrc,w:e.videoWidth,h:e.videoHeight,vdur:i,tw:0,ls:e.opts.live,t:t},r=null,a=null}var c=function(e){try{s()}catch(t){l(t)}},d=function(t){try{r=e.currentTime,a=(new Date).getTime()}catch(i){l(i)}},u=function(t){try{if(r&&0==e.playerState["is-seeking"]){var i=e.currentTime-r,c=.001*((new Date).getTime()-a);if(i>0){if(i>1)return;var d=o();n.videos[d]?(e.currentTime!=r&&c>0&&c<1&&(n.videos[d].tw+=c),n.videos[d].vdur<e.duration&&(n.videos[d].vdur=e.duration)):s()}}r=e.currentTime,a=(new Date).getTime()}catch(u){l(u)}};function l(r){e.off("loadedmetadata",c),e.off("seeked",d),e.off("timeupdate",u),n.sendVideoError(t,i,r)}e.on("loadedmetadata",c),e.on("seeked",d),e.on("timeupdate",u)},this.trackJW=function(e,t,i){var n=this,r=null,a=null;function o(e){return"".concat(e.file,"_").concat(e.title)}function s(){var t=e.getPlaylistItem();if(void 0!==t){var i=o(t);if(!n.videos[i]){var s=e.getConfig?e.getConfig():void 0;n.videos[i]={vid:t.file,w:e.getWidth(),h:e.getHeight(),vdur:e.getDuration(),tw:0,ls:!!s&&(s&&"Live"==s.streamType),t:t.title},n.videos[i].vdur<0&&(n.videos[i].vdur=0)}r=e.getPosition(),a=(new Date).getTime()}}var c=function(e){try{s()}catch(t){l(t)}},d=function(e){try{r=e.offset}catch(t){l(t)}},u=function(t){try{if(r){var i=.001*((new Date).getTime()-a),c=e.getPlaylistItem();if(void 0===c)return;var d=o(c);void 0===n.videos[d]&&s(),t.position!=r&&i>0&&i<1&&(n.videos[d].tw+=i),n.videos[d].h||(n.videos[d].h=e.getHeight()),n.videos[d].w||(n.videos[d].w=e.getWidth()),(!n.videos[d].vdur||n.videos[d].vdur<e.getDuration())&&(n.videos[d].vdur=e.getDuration())}r=t.position,a=(new Date).getTime()}catch(u){l(u)}};function l(r){e.off&&(e.off("play",c),e.off("seek",d),e.off("time",u)),n.sendVideoError(t,i,r)}e.on?(e.on("play",c),e.on("seek",d),e.on("time",u)):(e.onPlay(c),e.onSeek(d),e.onTime(u))},this.trackVideoJS=function(e,t,i){var n=this,r=null,a=null;function o(){var t=e.mediainfo?e.mediainfo.name:"",i=e.currentSrc();return"".concat(i,"_").concat(t)}function s(){var t=e.currentSrc();if(""!=t){var i=o();n.videos[i]||(n.videos[i]={vid:t,w:"function"==typeof e.videoWidth?e.videoWidth():e.width(),h:"function"==typeof e.videoHeight?e.videoHeight():e.height(),vdur:e.duration(),tw:0,ls:!1,t:e.mediainfo?e.mediainfo.name:""},n.videos[i].vdur<0&&(n.videos[i].vdur=0),r=null,a=null)}}var c=function(){try{s()}catch(e){u(e)}},d=function(){try{if(r&&0==e.seeking()&&("function"!=typeof e.scrubbing||0==e.scrubbing())){var t=.001*((new Date).getTime()-a);if(""==e.currentSrc())return;var i=o();if(void 0===n.videos[i])return void s();try{n.videos[i].ls=n.videos[i].ls||"undefined"!=e.liveTracker&&e.liveTracker.isLive&&e.liveTracker.isLive()}catch(d){}var c=!1;try{c="adPlaying"==e.playerState.getStateName()}catch(d){}n.videos[i].vdur<e.duration()&&(n.videos[i].vdur=e.duration()),0==c&&e.currentTime()!=r&&t>0&&t<1&&(n.videos[i].tw+=t)}r=e.currentTime(),a=(new Date).getTime()}catch(d){u(d)}};function u(r){e.off("loadedmetadata",c),e.off("timeupdate",d),n.sendVideoError(t,i,r)}e.on("loadedmetadata",c),e.on("timeupdate",d)},this.getVideoData=function(){var e=this.videos,t=[];for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];if(!n.vid||""==n.vid||n.vid.indexOf("data:video")>=0)continue;n.w=Math.round(n.w),n.h=Math.round(n.h),n.w||(n.w=0),n.h||(n.h=0),n.vdur&&isFinite(n.vdur)?(n.vdur=Math.round(n.vdur),n.vdur<0&&(n.vdur=0)):n.vdur=0,n.tw>0&&n.tw<1&&(n.tw=1),n.tw=Math.round(n.tw),n.tw>0&&t.push(n)}return t}};window.DotMetricsObj={onAjaxDataUpdate:function(){p.onAjaxDataUpdate()},HandleJsonp:function(e){p.HandleJsonp(e)},HandlePing:function(e){p.HandlePing(e)}},top.location==self.location&&setTimeout((function(){p.Start()}),100)}();
